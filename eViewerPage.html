<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <title>Split Document with Undo/Redo</title>

    <style type="text/css">
      .drop-zone {
        max-width: 200px;
        height: 200px;
        padding: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-family: "Quicksand", sans-serif;
        font-weight: 500;
        font-size: 20px;
        cursor: pointer;
        color: #cccccc;
        border: 4px dashed #009578;
        border-radius: 10px;
        margin-left: 30%;
      }

      .drop-zone--over {
        border-style: solid;
      }

      .drop-zone__input {
        display: none !important;
      }
      .custom_anchor_link {
        -webkit-box-align: center;
        align-items: center;
        border-radius: 4px;
        border: 2px solid rgb(231, 235, 238);
        height: 44px;
        padding: 5px 0px;
        cursor: pointer;
        margin-bottom: 10px;
        margin-left: 5px;
        margin-right: 5px;
      }
      .custom_anchor_link a {
        padding: 15px 10px 10px;
        font-family: proxima-nova;
        font-size: 16px;
        line-height: 16px;
        color: #455a64;
        letter-spacing: -0.3px;
        font-weight: 600;
      }
      .custom_anchor_link button {
        font-family: proxima-nova;
        font-size: 16px;
        line-height: 16px;
        color: #455a64;
        letter-spacing: -0.3px;
        font-weight: 600;
        border: none;
        background: none;
      }
      .ms-auto {
        margin-left: auto !important;
      }
      .btn-info:hover {
        box-shadow: none !important;
      }
      .btn-info:active {
        box-shadow: none !important;
      }
      .custom_viewer_font p {
        font-family: proxima-nova;
        font-size: 16px;
        line-height: 20px;
        color: #455a64;
        letter-spacing: -0.3px;
        padding: 10px 10px 0px;
      }
      .container_apis {
        background-color: #f1f3f5;
        position: absolute;
        top: 15px;
        left: 1100px;
        z-index: 100;
        height: 70px;
        width: 70px;
        border-radius: 50px;
        border: 2px solid #000;
      }

      .api_classes {
        height: 300px;
        width: fit-content;
        position: relative;
        background-color: #e7edf3;
        top: 30px;
        left: 75px;
        border-radius: 5px;
        border: 1px solid;
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="root">
      <h2 style="margin-left: 10px">Split Document</h2>
      <div
        id="formContainer"
        style="
          display: flex;
          align-items: center;
          gap: 20px;
          margin: 0 10px;
          flex-wrap: wrap;
        "
      >
        <form id="uploadForm" onsubmit="OnSubmitClick(); return false;">
          <input
            type="text"
            id="upload"
            name="upload"
            placeholder="Enter document URL"
            required
            style="
              width: 280px;
              padding: 5px 10px;
              border: 1px solid #cbd5e1;
              border-radius: 5px;
              margin-right: 10px;
              margin-left: 10px;
              outline: none;
              transition: border-color 0.3s, box-shadow 0.3s;
            "
            onfocus="this.style.borderColor='#3b82f6'"
            onblur="this.style.borderColor='#cbd5e1'"
          />
          <button
            type="submit"
            style="
              background-color: #2563eb;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 5px 15px;
              cursor: pointer;
              font-weight: 500;
              transition: all 0.3s ease;
              box-shadow: 0 2px 6px rgba(37, 99, 235, 0.3);
            "
          >
            Submit
          </button>
        </form>

        <form id="insertForm" onsubmit="OnChooseFileClick(); return false;">
          <input
            type="file"
            id="fileInput"
            name="fileInput"
            required
            style="
              border: 1px solid #cbd5e1;
              border-radius: 5px;
              padding: 4px;
              margin-left: 10px;
              margin-right: 10px;
            "
          />
          <button
            type="submit"
            style="
              background-color: #2563eb;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 5px 15px;
              cursor: pointer;
              font-weight: 500;
              transition: all 0.3s ease;
              box-shadow: 0 2px 6px rgba(37, 99, 235, 0.3);
            "
          >
            Submit
          </button>
        </form>
      </div>
      <div style="display: flex; align-items: center">
        <form
          id="splitForm"
          onsubmit="callSplitDocApi(); return false;"
          style="display: flex; align-items: center; margin: 0; padding: 0"
        >
          <input
            type="text"
            name="pageNumber"
            placeholder="PageNo"
            style="
              padding: 5px 10px;
              border: 1px solid #cbd5e1;
              border-radius: 5px;
              margin-right: 10px;
              margin-left: 20px;
              outline: none;
              transition: border-color 0.3s, box-shadow 0.3s;
            "
            required
          />
          <button
            type="submit"
            style="
              margin: 10px 0px 10px 10px;
              background-color: #51699e;
              color: white;
              border: none;
              border-radius: 4px;
              padding: 5px 15px;
              cursor: pointer;
              font-weight: 400;
              transition: all 0.3s ease;
              box-shadow: 0 2px 6px rgba(78, 130, 243, 0.3);
            "
          >
            Split Document
          </button>
        </form>

        <button
          onclick="callUndoApi()"
          style="
            margin: 10px 0px 10px 10px;
            background-color: #51699e;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 15px;
            cursor: pointer;
            font-weight: 400;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(78, 130, 243, 0.3);
          "
        >
          Undo
        </button>

        <button
          onclick="callRedoApi()"
          style="
            margin: 10px 0px 10px 10px;
            background-color: #51699e;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 15px;
            cursor: pointer;
            font-weight: 400;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(78, 130, 243, 0.3);
          "
        >
          Redo
        </button>
      </div>

      <style>
        button:hover {
          background-color: #1d4ed8;
          box-shadow: 0 4px 10px rgba(37, 99, 235, 0.4);
          transform: translateY(-1px);
        }

        input:focus {
          box-shadow: 0 0 4px rgba(37, 99, 235, 0.3);
        }
      </style>

      <div id="viewer"></div>
    </div>
    <script src="./js/eViewer7_browser.js" defer></script>
    <script src="scripts/loadViewer_Script.js"></script>

    <script defer>
      var global = global || window;
      window.addEventListener("DOMContentLoaded", function () {
        if (typeof loadDefaultComponent === "function") {
          loadDefaultComponent();
        } else {
          console.error("‚ùå loadDefaultComponent is not defined");
        }
      });
    </script>

    <script>
      function callSplitDocApi() {
        let userName = "";
        if (eViewerObj === null) {
          eViewerObj = new eViewerApp(userName);
        }
        let splitForm = document.getElementById("splitForm");
        let splitFromPageNo = splitForm.elements["pageNumber"].value;
        eViewerObj.splitDocument(splitFromPageNo).then((response) => {
          console.log("splitDocument: " + response);
          splitForm.reset();
        });
      }

      function callUndoApi() {
        let documentID = "";
        this.eViewerObj.documentService.getActiveDocument().then((response) => {
          documentID = response.viewerDocID;
        });
        eViewerObj.documentService.undo(documentID).then((response) => {
          console.log("DocumentId " + response);
        });
      }

      function callRedoApi() {
        let documentID = "";
        this.eViewerObj.documentService.getActiveDocument().then((response) => {
          documentID = response.viewerDocID;
        });
        eViewerObj.documentService.redo(documentID).then((response) => {
          console.log("DocumentId " + response);
        });
      }

      function OnChooseFileClick() {
        let userName = "";
        let insertForm = document.getElementById("insertForm");
        let file = [];
        file.push(document.getElementById("fileInput").files[0]);
        if (!file) {
          alert("Please choose a file first.");
          return;
        }
        if (this.eViewerObj === null) {
          this.eViewerObj = new eViewerApp(userName);
        }

        eViewerObj.setUserName(userName);
        let documentSrvc = eViewerObj.getDocumentService();
        documentSrvc
          .insertDocument(file, {
            pageFilters: [],
            captionMap: null,
          })
          .then((response) => {
            console.log("insertDocument: " + response);
            insertForm.reset();
          });
      }

      function OnSubmitClick() {
        setViewerOptions();
        let myform = document.getElementById("uploadForm");
        let docUrl = myform.elements["upload"].value;
        let saveUrl = "";
        let serverUrl = "";
        let annotationUrl = "";
        let userName = "";
        let isEditMode = true;
        let repoType = "filesystem";
        let fileName = "";
        let password = "";
        let token = "";
        let options = {
          type: "GET",
          headers: {
            Authorization: "Bearer " + token,
            Accept: "application/octet-stream.",
          },
          savePayLoadType: "application/json",
        };
        let clientDocId = Math.floor(Math.random() * 100);

        eViewerObj.setUserName(userName);
        eViewerObj.setDocumentEndPointOptions(options, serverUrl, saveUrl);
        let documentSrvc = eViewerObj.getDocumentService();
        documentSrvc
          .loadDocumentWithOptions(docUrl, annotationUrl, clientDocId, {
            isEditMode: 1,
            repoType: "filesystem",
            password: "",
            landingPage: 1,
            tabStyle: {
              fileName: "some-document-description-OUTFOCUS",
            },
            focusTabStyle: {
              fileName: "some-document-description-INFOCUS",
            },
          })
          .then((response) => {
            console.log("loadDocument");
            myform.reset();
          });
      }
    </script>
  </body>
</html>
